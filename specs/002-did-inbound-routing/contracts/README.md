# API Contracts: DID Inventory & Inbound Routing Management

**Feature**: DID Inventory & Inbound Routing Management
**Base Path**: `/api/v1/dids`
**Date**: 2026-01-06

## OpenAPI Specification

The complete OpenAPI 3.0 specification for DID management endpoints is auto-generated by FastAPI at runtime.

**Access OpenAPI Docs**:
- **Interactive Docs (Swagger UI)**: `http://localhost:8000/docs#/DIDs`
- **ReDoc**: `http://localhost:8000/redoc#tag/DIDs`
- **OpenAPI JSON**: `http://localhost:8000/openapi.json`

## Endpoint Summary

| Method | Path | Description | RBAC |
|--------|------|-------------|------|
| POST | `/dids/import` | Bulk import DIDs from carrier | platform_admin |
| GET | `/dids` | List DIDs with filters/pagination | platform_admin, tenant_admin, support |
| GET | `/dids/{id}` | Get DID details with assignment | platform_admin, tenant_admin, support |
| PATCH | `/dids/{id}/allocate` | Allocate DID to tenant | platform_admin |
| PATCH | `/dids/{id}/deallocate` | Deallocate DID from tenant | platform_admin |
| POST | `/dids/{id}/assign` | Assign DID to destination | tenant_admin |
| DELETE | `/dids/{id}/assign` | Unassign DID | tenant_admin |

## Request/Response Schemas

See `src/schemas/phone_number.py` for Pydantic schemas:
- `DIDImportRequest` / `DIDImportResponse`
- `DIDAllocateRequest`
- `DIDAssignRequest`
- `PhoneNumberResponse`
- `PhoneNumberListResponse`
- `DIDAssignmentResponse`

## RBAC Matrix

| Endpoint | platform_admin | tenant_admin | support | end_user |
|----------|----------------|--------------|---------|----------|
| Import DIDs | ✅ | ❌ | ❌ | ❌ |
| List DIDs | ✅ (all) | ✅ (own tenant) | ✅ (all, read-only) | ❌ |
| Get DID | ✅ | ✅ (own tenant) | ✅ (read-only) | ❌ |
| Allocate | ✅ | ❌ | ❌ | ❌ |
| Deallocate | ✅ | ❌ | ❌ | ❌ |
| Assign | ✅ | ✅ (own tenant DIDs) | ❌ | ❌ |
| Unassign | ✅ | ✅ (own tenant DIDs) | ❌ | ❌ |

For complete API documentation, run the server and visit `/docs`.
